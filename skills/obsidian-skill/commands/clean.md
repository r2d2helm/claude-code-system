# Commande: /obs-clean

Nettoyer et optimiser le vault Obsidian.

## Syntaxe

```
/obs-clean [action] [options]
```

## Actions

### /obs-clean (analyse)

Analyser ce qui peut Ãªtre nettoyÃ© :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ§¹ ANALYSE NETTOYAGE                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  ğŸ“Š Ã‰LÃ‰MENTS DÃ‰TECTÃ‰S:                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Type                      Nombre    Taille   Action     â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â•‘
â•‘  â”‚ ğŸ“„ Notes vides              5       2 KB     Supprimer  â”‚ â•‘
â•‘  â”‚ ğŸ“ Attachments orphelins   12      45 MB     Supprimer  â”‚ â•‘
â•‘  â”‚ ğŸ“ Dossiers vides           3       0 KB     Supprimer  â”‚ â•‘
â•‘  â”‚ ğŸ”„ Fichiers temporaires     8      12 KB     Supprimer  â”‚ â•‘
â•‘  â”‚ ğŸ“‹ Doublons potentiels      2      89 KB     Examiner   â”‚ â•‘
â•‘  â”‚ ğŸ—‚ï¸ Cache Obsidian          --      234 MB    Nettoyer   â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  ğŸ’¾ ESPACE RÃ‰CUPÃ‰RABLE: ~280 MB                              â•‘
â•‘                                                              â•‘
â•‘  âš ï¸ AVERTISSEMENTS:                                          â•‘
â•‘  â€¢ 12 attachments non rÃ©fÃ©rencÃ©s seront supprimÃ©s            â•‘
â•‘  â€¢ Le cache Obsidian sera reconstruit au prochain lancement  â•‘
â•‘                                                              â•‘
â•‘  [1] Nettoyer tout  [2] SÃ©lectionner  [3] Annuler            â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### /obs-clean --all

Nettoyage complet automatique :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ§¹ NETTOYAGE EN COURS                     â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100%             â•‘
â•‘                                                              â•‘
â•‘  âœ… Notes vides supprimÃ©es          : 5                      â•‘
â•‘  âœ… Attachments orphelins supprimÃ©s : 12 (45 MB)             â•‘
â•‘  âœ… Dossiers vides supprimÃ©s        : 3                      â•‘
â•‘  âœ… Fichiers temporaires supprimÃ©s  : 8                      â•‘
â•‘  âœ… Cache Obsidian nettoyÃ©          : 234 MB                 â•‘
â•‘                                                              â•‘
â•‘  ğŸ“Š RÃ‰SUMÃ‰:                                                  â•‘
â•‘  â€¢ Fichiers supprimÃ©s : 28                                   â•‘
â•‘  â€¢ Espace libÃ©rÃ©      : 279 MB                               â•‘
â•‘  â€¢ Temps              : 4.2s                                 â•‘
â•‘                                                              â•‘
â•‘  ğŸ’¡ RedÃ©marrez Obsidian pour reconstruire le cache           â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### /obs-clean empty

Supprimer notes vides :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ“„ NOTES VIDES                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  TrouvÃ©es: 5 notes vides ou quasi-vides                      â•‘
â•‘                                                              â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Fichier                          Taille    Contenu      â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â•‘
â•‘  â”‚ _Inbox/Untitled.md               0 KB      (vide)       â”‚ â•‘
â•‘  â”‚ _Inbox/New-Note.md               0.1 KB    "# "         â”‚ â•‘
â•‘  â”‚ Conversations/Draft.md           0.2 KB    frontmatter  â”‚ â•‘
â•‘  â”‚ Code/test.md                     0 KB      (vide)       â”‚ â•‘
â•‘  â”‚ Projets/temp.md                  0.1 KB    "---"        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  [1] Supprimer toutes  [2] SÃ©lectionner  [3] Annuler         â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### /obs-clean attachments

GÃ©rer les attachments (images, PDF, etc.) :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ“ ATTACHMENTS                            â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  ğŸ“Š STATISTIQUES:                                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ Type          Fichiers    Taille    RÃ©fÃ©rencÃ©s          â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ â•‘
â•‘  â”‚ Images PNG       45       23 MB        42 âœ…            â”‚ â•‘
â•‘  â”‚ Images JPG       38       45 MB        35 âœ…            â”‚ â•‘
â•‘  â”‚ PDF              34      156 MB        32 âœ…            â”‚ â•‘
â•‘  â”‚ Autres           12        8 MB        10 âœ…            â”‚ â•‘
â•‘  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚ â•‘
â•‘  â”‚ TOTAL           129      232 MB       119               â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  âš ï¸ ORPHELINS (non rÃ©fÃ©rencÃ©s): 10 fichiers (45 MB)          â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ _Attachments/image-2025-old.png        (12 MB)          â”‚ â•‘
â•‘  â”‚ _Attachments/screenshot-123.png        (2 MB)           â”‚ â•‘
â•‘  â”‚ _Attachments/document-backup.pdf       (25 MB)          â”‚ â•‘
â•‘  â”‚ ... (+7 autres)                                         â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  [1] Supprimer orphelins  [2] DÃ©placer vers archive          â•‘
â•‘  [3] Exporter liste       [4] Annuler                        â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### /obs-clean duplicates

DÃ©tecter et gÃ©rer les doublons :

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    ğŸ”„ DOUBLONS DÃ‰TECTÃ‰S                      â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                              â•‘
â•‘  MÃ©thode: Hash MD5 du contenu                                â•‘
â•‘                                                              â•‘
â•‘  Groupe 1 (contenu identique):                               â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ ğŸ“„ Concepts/C_Docker-Intro.md           (crÃ©Ã©: 2026-01) â”‚ â•‘
â•‘  â”‚ ğŸ“„ _Inbox/Docker-Notes.md               (crÃ©Ã©: 2026-02) â”‚ â•‘
â•‘  â”‚    â†’ Suggestion: Garder C_Docker-Intro.md (plus ancien) â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  Groupe 2 (trÃ¨s similaire - 95%):                            â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚ ğŸ“„ Projets/API/Endpoints.md                             â”‚ â•‘
â•‘  â”‚ ğŸ“„ Projets/API/API-Endpoints.md                         â”‚ â•‘
â•‘  â”‚    â†’ DiffÃ©rence: 3 lignes                               â”‚ â•‘
â•‘  â”‚    â†’ Suggestion: Fusionner                              â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                              â•‘
â•‘  [1] Supprimer doublons  [2] Examiner chaque  [3] Annuler    â•‘
â•‘                                                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### /obs-clean cache

Nettoyer le cache Obsidian :

```powershell
/obs-clean cache
```

Supprime :
- `.obsidian/cache`
- `.obsidian/workspace.json` (optionnel)
- Index de recherche corrompu

## Script PowerShell

```powershell
function Invoke-VaultCleanup {
    param(
        [string]$VaultPath = "$env:USERPROFILE\Documents\Knowledge",
        [switch]$DryRun,
        [switch]$All
    )
    
    $Results = @{
        EmptyNotes = @()
        OrphanAttachments = @()
        EmptyFolders = @()
        TempFiles = @()
        Duplicates = @()
        SpaceSaved = 0
    }
    
    Write-Host "`nğŸ§¹ Analyse du vault: $VaultPath`n" -ForegroundColor Cyan
    
    # === NOTES VIDES ===
    $Notes = Get-ChildItem -Path $VaultPath -Recurse -Filter "*.md"
    foreach ($Note in $Notes) {
        $Content = Get-Content $Note.FullName -Raw -ErrorAction SilentlyContinue
        $ContentLength = if ($Content) { 
            ($Content -replace '---[\s\S]*?---', '').Trim().Length 
        } else { 0 }
        
        if ($ContentLength -lt 10) {
            $Results.EmptyNotes += $Note
            $Results.SpaceSaved += $Note.Length
        }
    }
    Write-Host "  ğŸ“„ Notes vides: $($Results.EmptyNotes.Count)" -ForegroundColor Yellow
    
    # === ATTACHMENTS ORPHELINS ===
    $AllContent = $Notes | ForEach-Object { Get-Content $_.FullName -Raw } | Out-String
    $Attachments = Get-ChildItem -Path $VaultPath -Recurse -Include "*.png","*.jpg","*.jpeg","*.gif","*.pdf","*.webp","*.svg"
    
    foreach ($Att in $Attachments) {
        $Referenced = $AllContent -match [regex]::Escape($Att.Name)
        if (!$Referenced) {
            $Results.OrphanAttachments += $Att
            $Results.SpaceSaved += $Att.Length
        }
    }
    Write-Host "  ğŸ“ Attachments orphelins: $($Results.OrphanAttachments.Count)" -ForegroundColor Yellow
    
    # === DOSSIERS VIDES ===
    $Folders = Get-ChildItem -Path $VaultPath -Recurse -Directory
    foreach ($Folder in $Folders) {
        $Items = Get-ChildItem -Path $Folder.FullName -Force
        if ($Items.Count -eq 0) {
            $Results.EmptyFolders += $Folder
        }
    }
    Write-Host "  ğŸ“ Dossiers vides: $($Results.EmptyFolders.Count)" -ForegroundColor Yellow
    
    # === FICHIERS TEMPORAIRES ===
    $TempPatterns = @("*.tmp", "*.bak", "*.swp", "*~", ".DS_Store", "Thumbs.db")
    foreach ($Pattern in $TempPatterns) {
        $TempFiles = Get-ChildItem -Path $VaultPath -Recurse -Filter $Pattern -Force
        foreach ($Temp in $TempFiles) {
            $Results.TempFiles += $Temp
            $Results.SpaceSaved += $Temp.Length
        }
    }
    Write-Host "  ğŸ”„ Fichiers temporaires: $($Results.TempFiles.Count)" -ForegroundColor Yellow
    
    # === RÃ‰SUMÃ‰ ===
    Write-Host "`n  ğŸ’¾ Espace rÃ©cupÃ©rable: $([Math]::Round($Results.SpaceSaved / 1MB, 2)) MB" -ForegroundColor Green
    
    # === NETTOYAGE ===
    if (!$DryRun -and ($All -or (Read-Host "`nProcÃ©der au nettoyage? [O/N]") -in @('O','o','Y','y'))) {
        
        # Supprimer notes vides
        foreach ($Note in $Results.EmptyNotes) {
            Remove-Item $Note.FullName -Force
        }
        
        # Supprimer attachments orphelins
        foreach ($Att in $Results.OrphanAttachments) {
            Remove-Item $Att.FullName -Force
        }
        
        # Supprimer dossiers vides
        foreach ($Folder in $Results.EmptyFolders) {
            Remove-Item $Folder.FullName -Force -ErrorAction SilentlyContinue
        }
        
        # Supprimer fichiers temporaires
        foreach ($Temp in $Results.TempFiles) {
            Remove-Item $Temp.FullName -Force
        }
        
        Write-Host "`nâœ… Nettoyage terminÃ©!" -ForegroundColor Green
    }
    
    return $Results
}

function Find-OrphanAttachments {
    param([string]$VaultPath)
    
    $Notes = Get-ChildItem -Path $VaultPath -Recurse -Filter "*.md"
    $AllContent = $Notes | ForEach-Object { Get-Content $_.FullName -Raw } | Out-String
    
    $Attachments = Get-ChildItem -Path $VaultPath -Recurse -Include "*.png","*.jpg","*.jpeg","*.gif","*.pdf","*.webp"
    $Orphans = @()
    
    foreach ($Att in $Attachments) {
        if ($AllContent -notmatch [regex]::Escape($Att.Name)) {
            $Orphans += [PSCustomObject]@{
                Name = $Att.Name
                Path = $Att.FullName
                Size = $Att.Length
                LastModified = $Att.LastWriteTime
            }
        }
    }
    
    return $Orphans
}

function Find-DuplicateNotes {
    param([string]$VaultPath)
    
    $Notes = Get-ChildItem -Path $VaultPath -Recurse -Filter "*.md"
    $Hashes = @{}
    $Duplicates = @()
    
    foreach ($Note in $Notes) {
        $Content = Get-Content $Note.FullName -Raw
        # Ignorer frontmatter pour le hash
        $Content = $Content -replace '---[\s\S]*?---', ''
        $Hash = [System.BitConverter]::ToString(
            [System.Security.Cryptography.MD5]::Create().ComputeHash(
                [System.Text.Encoding]::UTF8.GetBytes($Content.Trim())
            )
        )
        
        if ($Hashes[$Hash]) {
            $Duplicates += [PSCustomObject]@{
                Original = $Hashes[$Hash]
                Duplicate = $Note.FullName
                Hash = $Hash
            }
        } else {
            $Hashes[$Hash] = $Note.FullName
        }
    }
    
    return $Duplicates
}

function Clear-ObsidianCache {
    param([string]$VaultPath)
    
    $CachePath = Join-Path $VaultPath ".obsidian\cache"
    $WorkspacePath = Join-Path $VaultPath ".obsidian\workspace.json"
    
    $Cleared = 0
    
    if (Test-Path $CachePath) {
        $Size = (Get-ChildItem $CachePath -Recurse | Measure-Object -Property Length -Sum).Sum
        Remove-Item $CachePath -Recurse -Force
        $Cleared += $Size
        Write-Host "âœ… Cache supprimÃ©: $([Math]::Round($Size / 1MB, 2)) MB"
    }
    
    return $Cleared
}
```

## Options

| Option | Description |
|--------|-------------|
| `--all` | Nettoyer tout automatiquement |
| `--dry-run` | PrÃ©visualiser sans supprimer |
| `--backup` | Backup avant nettoyage |
| `--force` | Pas de confirmation |
| `--exclude=pattern` | Exclure fichiers/dossiers |

## Exemples

```powershell
# Analyser
/obs-clean

# Nettoyer tout
/obs-clean --all

# Supprimer notes vides uniquement
/obs-clean empty

# Nettoyer attachments orphelins
/obs-clean attachments --delete

# PrÃ©visualiser
/obs-clean --dry-run

# Nettoyer cache Obsidian
/obs-clean cache
```
